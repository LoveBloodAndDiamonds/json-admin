<!doctype html>
<html lang="ru" data-theme="light">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>{{ page_title or app_title }}</title>
        <style>
            :root {
                --bg: #ffffff;
                --panel: #f7f7f8;
                --text: #1a1a1b;
                --muted: #6c6c70;
                --accent: #007aff;
                --border: #e5e5ea;
                --success: #177245;
                --error: #b42318;
            }
            html[data-theme="dark"] {
                --bg: #000000;
                --panel: #111113;
                --text: #e1e1e1;
                --muted: #9a9aa0;
                --accent: #0a84ff;
                --border: #222226;
                --success: #2fb170;
                --error: #ff6b6b;
            }
            * {
                box-sizing: border-box;
            }
            body {
                margin: 0;
                background: var(--bg);
                color: var(--text);
                font:
                    13px/1.5 "JetBrains Mono",
                    "SFMono-Regular",
                    Menlo,
                    monospace;
            }
            .wrap {
                max-width: 920px;
                margin: 0 auto;
                padding: 20px;
            }
            .top {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 16px;
            }
            .title {
                font-size: 15px;
                font-weight: 600;
            }
            button {
                border: 1px solid var(--border);
                background: transparent;
                color: var(--text);
                padding: 6px 10px;
                border-radius: 8px;
                cursor: pointer;
                font: inherit;
            }
            button:focus-visible,
            textarea:focus-visible,
            input:focus-visible,
            a:focus-visible {
                outline: 2px solid var(--accent);
                outline-offset: 2px;
            }
            .tabs {
                display: flex;
                gap: 10px;
                margin-bottom: 12px;
                flex-wrap: wrap;
            }
            .tabs a,
            .tabs span {
                color: var(--text);
                text-decoration: none;
                padding-bottom: 1px;
                border-bottom: 1px solid transparent;
            }
            .tabs span {
                border-bottom-color: var(--accent);
                font-weight: 600;
            }
            .panel {
                border: 1px solid var(--border);
                background: var(--panel);
                border-radius: 10px;
                padding: 12px;
            }
            textarea {
                width: 100%;
                min-height: 420px;
                border: 1px solid var(--border);
                border-radius: 8px;
                background: var(--bg);
                color: var(--text);
                padding: 12px;
                resize: vertical;
                font: inherit;
            }
            input[type="password"] {
                width: 100%;
                border: 1px solid var(--border);
                border-radius: 8px;
                background: var(--bg);
                color: var(--text);
                padding: 10px 12px;
                font: inherit;
            }
            .row {
                display: flex;
                gap: 8px;
                margin-top: 10px;
                align-items: center;
            }
            .msg-error {
                color: var(--error);
                margin: 0 0 10px;
            }
            .msg-success {
                color: var(--success);
                margin: 0 0 10px;
            }
            pre {
                margin: 12px 0 0;
                border: 1px solid var(--border);
                border-radius: 8px;
                padding: 12px;
                overflow: auto;
                background: var(--bg);
                color: var(--muted);
            }
        </style>
    </head>
    <body>
        <div class="wrap">{% block content %}{% endblock %}</div>
        <script>
            (() => {
                const storageKey = "jsonadmin-theme";
                const root = document.documentElement;
                const savedTheme = localStorage.getItem(storageKey);
                const systemDark = window.matchMedia(
                    "(prefers-color-scheme: dark)",
                ).matches;
                const initialTheme =
                    savedTheme || (systemDark ? "dark" : "light");
                root.setAttribute("data-theme", initialTheme);

                document.addEventListener("click", (event) => {
                    const target = event.target;
                    if (!(target instanceof HTMLElement)) {
                        return;
                    }
                    if (target.dataset.action !== "toggle-theme") {
                        return;
                    }

                    const current =
                        root.getAttribute("data-theme") === "dark"
                            ? "dark"
                            : "light";
                    const next = current === "dark" ? "light" : "dark";
                    root.setAttribute("data-theme", next);
                    localStorage.setItem(storageKey, next);
                });
            })();
        </script>
    </body>
</html>
